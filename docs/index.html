<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-08-22">

<title>Memo: Swing States Project and Estimating PID</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-question-and-hypotheses" id="toc-research-question-and-hypotheses" class="nav-link active" data-scroll-target="#research-question-and-hypotheses">Research Question and Hypotheses</a></li>
  <li><a href="#estimating-partisan-identification-at-the-state-level" id="toc-estimating-partisan-identification-at-the-state-level" class="nav-link" data-scroll-target="#estimating-partisan-identification-at-the-state-level">Estimating Partisan Identification at the State Level</a>
  <ul class="collapse">
  <li><a href="#available-data" id="toc-available-data" class="nav-link" data-scroll-target="#available-data">Available Data</a>
  <ul class="collapse">
  <li><a href="#polling-data" id="toc-polling-data" class="nav-link" data-scroll-target="#polling-data">Polling Data</a></li>
  <li><a href="#publicly-available-registration-data" id="toc-publicly-available-registration-data" class="nav-link" data-scroll-target="#publicly-available-registration-data">Publicly Available Registration Data</a></li>
  <li><a href="#demographic-data" id="toc-demographic-data" class="nav-link" data-scroll-target="#demographic-data">Demographic Data</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#preliminary-results" id="toc-preliminary-results" class="nav-link" data-scroll-target="#preliminary-results">Preliminary Results</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#to-do" id="toc-to-do" class="nav-link" data-scroll-target="#to-do">To do</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Memo: Swing States Project and Estimating PID</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 22, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="research-question-and-hypotheses" class="level1">
<h1>Research Question and Hypotheses</h1>
<p><strong>Research question:</strong> Why does a state become a swing state, or, why do states swing in presidential elections? - Are we interested in thinking of as a temporary state or a durable trait, or both?</p>
<section id="main-hypotheses-rough" class="level4">
<h4 class="anchored" data-anchor-id="main-hypotheses-rough">Main Hypotheses (Rough)</h4>
<ol type="1">
<li>As a given state’s legislative branch becomes more polarized, the state is more likely to swing in presidential elections.</li>
</ol>
</section>
<section id="competing-hypotheses-partisanship" class="level4">
<h4 class="anchored" data-anchor-id="competing-hypotheses-partisanship">Competing Hypotheses – Partisanship</h4>
<ol start="2" type="1">
<li>As the proportion of a state’s voters identifying as true independents increases, the state is more likely to swing in presidential elections.</li>
<li>As a state’s two-party make-up shifts towards equal proportions for both parties, the state is more likely to swing in presidential elections.</li>
</ol>
</section>
<section id="causal-drivers" class="level4">
<h4 class="anchored" data-anchor-id="causal-drivers">Causal Drivers:</h4>
<ul>
<li>elite polarization</li>
<li>Partisan realignment: migration, birth rates, attitude shifts</li>
</ul>
</section>
</section>
<section id="estimating-partisan-identification-at-the-state-level" class="level1">
<h1>Estimating Partisan Identification at the State Level</h1>
<p>We will estimate our state-level partisanship variable using Multilevel Regression and Poststratification (MRP) within a Bayesian framework <span class="citation" data-cites="pacheco2011Using">Buttice and Highton (<a href="#ref-buttice2013How" role="doc-biblioref">2013</a>)</span>. To perform MRP, we need two types of data: demographic population data, and polling data. The polling data is used to fit a multinomial logistic model that estimates the individual-level probability of a given respondent identifying as a Democrat, Republican, or Independent. The administrative data is then used to create a poststratification frame, which is essentially a joint distribution of individual-level demographics that are parsed out by geographic unit(s) such as counties or states.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Each row of this distribution can be thought of as a demographic profile that exists in the population for a given geography. The frequencies of these profiles in the geographic level of interest can then be used to predict weighted probabilities of each profile identifying as a Democrat, Republican, or Independent in each state, which can then be aggregated to any available geographic level to obtain proportions of those identifying with each party.</p>
<p>This approach aligns well with our broader project for a few reasons. Most importantly, the multilevel model allows for the pooling information across levels of the variables, which is especially useful when estimating states with small sample sizes. The multilevel model also allows us to make reasonable predictions of partisan identification for geographies that were not sampled in the available polling data for one or more years of interest. This is because in a multilevel framework we compute means at every level of analysis, which allows us to incorporate information about a state’s region and other characteristics in our estimates.</p>
<p>The above explanation is the standard MRP implementation for estimating state-level opinion for a single year. Because we are interested in generating partisanship estimates for several years, some modifications to the above framework are necessary. Luckily, the longitudinal nature of our question can be used to our advantage when it comes to generating optimal partisanship estimates. If we combine all available polling data across years into a single dataset and estimate the model with varying year intercepts then information will also be shared across geographies in all years of the analysis, which provides additional robustness to our estimates.</p>
<p>Another stumbling block for estimating state-level partisanship is that the available polling data is usually area-cluster sampled, which means that they are likely not representative of the individual state populations being studied. TIn many recent years, the American National Election Study has used simple random sampling to obtain a portion of its overall sample, which mitigates this issue to an extent. However, it has been proposed that the problem could be further addressed by accounting for the sampling design of area-clustered samples in the predictive model itself (<span class="citation" data-cites="stollwerkEssays">Stollwerk (<a href="#ref-stollwerkEssays" role="doc-biblioref">n.d.</a>)</span>). This is achieved by including random effects for the geographic units that were used in area clustered sampling when survey data was collected. The resulting partial pooling of information across geographies smaller than the state will improve all of our estimates because it will provide information about a state that would be otherwise missing for any given year by borrowing means generated within that state from other years during prediciton. The extent to which this approach can be implemented depends upon the available polling and demographic data.</p>
<section id="available-data" class="level2">
<h2 class="anchored" data-anchor-id="available-data">Available Data</h2>
<section id="polling-data" class="level3">
<h3 class="anchored" data-anchor-id="polling-data">Polling Data</h3>
<p>Because our main and perhaps only consistent source of polling data is the ANES data we have obtained access to, it would be helpful to combine the ANES with other polls. This section discusses the available polling data and its limitations.</p>
<section id="existing-estimates" class="level4">
<h4 class="anchored" data-anchor-id="existing-estimates">Existing Estimates</h4>
<p><span class="citation" data-cites="pacheco2014Measuring">Pacheco (<a href="#ref-pacheco2014Measuring" role="doc-biblioref">2014</a>)</span> provides poll-based estimates for the proportion of Democrat identifiers out of all partisans (Republicans Democrats, and Independents) for 1978 to 2010. These estimates are primarily based on CBS/NYT polls. They utilize an older and less accurate approach to MRP that does not utilize multiple deep interactions when specifying the multilevel model (called “deep MRP”) <span class="citation" data-cites="goplerud2023ReEvaluating">(see <a href="#ref-goplerud2023ReEvaluating" role="doc-biblioref">Goplerud 2023</a>)</span>, and they don’t account for the sampling design of the polls <span class="citation" data-cites="auslen2023Improving stollwerkEssays">(<a href="#ref-auslen2023Improving" role="doc-biblioref">Auslen 2023</a>; <a href="#ref-stollwerkEssays" role="doc-biblioref">Stollwerk n.d.</a>)</span>, making them of limited use for our purposes.</p>
</section>
<section id="cooperative-congressional-election-study" class="level4">
<h4 class="anchored" data-anchor-id="cooperative-congressional-election-study">Cooperative Congressional Election Study</h4>
<ul>
<li>Large sample size and an approximately simple random sample make it very reliable
<ul>
<li>MRP provides little improvement over simple mean estimates of state level public opinion <span class="citation" data-cites="gelmanChapter">(<a href="#ref-gelmanChapter" role="doc-biblioref">Gelman n.d.</a>)</span></li>
<li>only available for 2006 to 2020</li>
<li>Because sub-state geographies aren’t included, something would need to be done before combining this data with our ANES data where we have sub-state geographies</li>
</ul></li>
</ul>
</section>
<section id="other-sources" class="level4">
<h4 class="anchored" data-anchor-id="other-sources">Other Sources</h4>
<ul>
<li><p>The General Social Survey</p>
<ul>
<li>excellent temporal coverage for its partisanship variable, going back to 1974</li>
<li>Doesn’t include state of residence by default</li>
<li>Doesn’t have a question that parses partisan leaners out of the independent category</li>
<li>Applying for restricted data access so we can use geocodes is an option</li>
</ul></li>
<li><p><a href="https://www.voterstudygroup.org/data">Nationscape</a> data appears to be very promising for geographic coverage, but it only began being collected in 2016.</p></li>
<li><p><a href="https://ropercenter.cornell.edu/ipoll/">Roper Center for Public Opinion Research’s iPoll database</a> of polls.</p>
<ul>
<li>Many of these are by news agencies</li>
<li>question wordings vary from those in the ANES, and I haven’t come across leaners being parsed out anywhere in this database</li>
<li>The problem of not having substate geographies is present</li>
</ul></li>
</ul>
</section>
<section id="polling-data-summary" class="level4">
<h4 class="anchored" data-anchor-id="polling-data-summary">Polling Data Summary</h4>
<p>Besides the ANES, polls are sparse and most comparable data is only readily available for recent years. This is a concern because, if the needed data were available, one benefit of adding additional polls is a more geographic diversity within states and less missing data at the state level. Because we can’t add additional data for the earlier half of our time-series where we need it the most, the utility of adding additional polls is limited. Another concern is the overall balance of the data. If we add additional polls for later years we risk artificially inflating their sample sizes and weighting all model estimates towards the means for later years. Because data is mostly missing or insufficient in the earlier years wher we need it most, it is possible that we will obtain better results by using the ANES data alone.</p>
</section>
</section>
<section id="publicly-available-registration-data" class="level3">
<h3 class="anchored" data-anchor-id="publicly-available-registration-data">Publicly Available Registration Data</h3>
<p>One good source of data would be the publicly registration data, however some states don’t report the partisanship of their registered voters, and the data becomes more sparse the further back in time we go. Figure 1 shows the missingness of the registration data by state and year. Each “row” in the graph represents one state in a given year (1988 to 2020).</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/registration-data-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="demographic-data" class="level3">
<h3 class="anchored" data-anchor-id="demographic-data">Demographic Data</h3>
<p>The availability of census-based demographic data also affects the type of partisanship model we can specify. The table below summarizes the census-based data that is available.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary of Census-based Data availability</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">Demographics</th>
<th style="text-align: right;">Counties</th>
<th style="text-align: right;">Census Tract</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1980 Decennial</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1990 Decennial</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2000 Decennial</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2010 Decennial</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2020 Decennial</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2008 ACS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2012 ACS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2016 ACS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2020 ACS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The demographic variables we need so we can generate a joint distributions for poststratifying (age, race, sex, educational attainment) are available in the 1980, 1990, and 2000 but not the 2010 or 2020 decennial censuses, likely because the American Community Survey (ACS) replaced the long-form census in 2010. One joint distribution is needed for each year of polling data we have, which will match presidential election years. Breakdowns of these demographics by geographies smaller than the state are available in all of the decennial censuses, and Google Cloud provides complete breakdowns of these demographics by state, county, and census tract for the ACS. Because of the limitations in the census-based data, it seems best to use decennial censuses for the earlier years and the ACS for the years it is available. For earlier years it will be necessary to interpollate new distributions for the years in between the decennial censuses, as <span class="citation" data-cites="kastellec2015Polarizing">Kastellec et al. (<a href="#ref-kastellec2015Polarizing" role="doc-biblioref">2015</a>)</span> did. Interpolation is also needed for the years between 2000 and 2010, where we would have to use the 2000 decennial census and the 2010 ACS. For years falling between 2010 to 2020 or we could use the ACS without interpolation because it is available for every year in that range, or interpollate for the sake of consistency.</p>
</section>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
</section>
<section id="preliminary-results" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-results">Preliminary Results</h2>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<section id="to-do" class="level2">
<h2 class="anchored" data-anchor-id="to-do">To do</h2>
<ul>
<li>Operationalizing “swinginess”</li>
</ul>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-auslen2023Improving" class="csl-entry" role="doc-biblioentry">
Auslen, Michael. 2023. <span>“Improving <span>Subnational Opinion Estimation</span> from <span>Cluster-Sampled Polls</span>.”</span> Preprint. <span>SocArXiv</span>. <a href="https://doi.org/10.31235/osf.io/gmyjh">https://doi.org/10.31235/osf.io/gmyjh</a>.
</div>
<div id="ref-buttice2013How" class="csl-entry" role="doc-biblioentry">
Buttice, Matthew K., and Benjamin Highton. 2013. <span>“How <span>Does Multilevel Regression</span> and <span>Poststratification Perform</span> with <span>Conventional National Surveys</span>? | <span>Political Analysis</span> | <span>Cambridge Core</span>.”</span> <em>Political Analysis</em>, no. 21: 449–67.
</div>
<div id="ref-gelmanChapter" class="csl-entry" role="doc-biblioentry">
Gelman, and Andrew, Justin H. Phillips. n.d. <em>Chapter 1 <span>Introduction</span> to <span>Mister P</span> | <span>Multilevel Regression</span> and <span>Poststratification Case Studies</span></em>. Accessed March 23, 2023.
</div>
<div id="ref-goplerud2023ReEvaluating" class="csl-entry" role="doc-biblioentry">
Goplerud, Max. 2023. <span>“Re-<span>Evaluating Machine Learning</span> for <span>MRP Given</span> the <span>Comparable Performance</span> of (<span>Deep</span>) <span>Hierarchical Models</span>.”</span> <em>American Political Science Review</em>, March, 1–8. <a href="https://doi.org/10.1017/S0003055423000035">https://doi.org/10.1017/S0003055423000035</a>.
</div>
<div id="ref-kastellec2015Polarizing" class="csl-entry" role="doc-biblioentry">
Kastellec, Jonathan P., Jeffrey R. Lax, Michael Malecki, and Justin H. Phillips. 2015. <span>“Polarizing the <span>Electoral Connection</span>: <span>Partisan Representation</span> in <span>Supreme Court Confirmation Politics</span>.”</span> <em>The Journal of Politics</em> 77 (3): 787–804. <a href="https://doi.org/10.1086/681261">https://doi.org/10.1086/681261</a>.
</div>
<div id="ref-pacheco2011Using" class="csl-entry" role="doc-biblioentry">
Pacheco, Julianna. 2011. <span>“Using <span>National Surveys</span> to <span>Measure Dynamic U</span>.<span>S</span>. <span>State Public Opinion</span>: <span>A Guideline</span> for <span>Scholars</span> and an <span>Application</span>.”</span> <em>State Politics &amp; Policy Quarterly</em> 11 (4): 415–39. <a href="https://doi.org/10.1177/1532440011419287">https://doi.org/10.1177/1532440011419287</a>.
</div>
<div id="ref-pacheco2014Measuring" class="csl-entry" role="doc-biblioentry">
———. 2014. <span>“Measuring and <span>Evaluating Changes</span> in <span>State Opinion Across Eight Issues</span>.”</span> <em>American Politics Research</em> 42 (6): 986–1009. <a href="https://doi.org/10.1177/1532673X14524819">https://doi.org/10.1177/1532673X14524819</a>.
</div>
<div id="ref-stollwerkEssays" class="csl-entry" role="doc-biblioentry">
Stollwerk, Alissa. n.d. <em>Essays on the <span>Measurement</span> of <span>Public Opinion</span></em>. Accessed February 21, 2023.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The weighting process is also greatly improved by the incluion of state-level predictors, such as the state’s region, previous electoral returns, and so on. This are included in the model as fixed effects, and must also be included in the poststratification frames in order for predictions to be possible.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>